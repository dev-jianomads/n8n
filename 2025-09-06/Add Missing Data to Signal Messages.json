{"createdAt":"2025-07-14T21:37:02.757Z","updatedAt":"2025-07-31T23:04:36.964Z","id":"rMwwPxGr7goRslXS","name":"Add Missing Data to Signal Messages","active":false,"isArchived":false,"nodes":[{"parameters":{"operation":"getAll","tableId":"signal_messages","matchType":"allFilters","filters":{"conditions":[{"keyName":"direction","condition":"eq","keyValue":"outbound"},{"keyName":"recipient_uuid","condition":"is","keyValue":"={{ null }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-740,-180],"id":"6723e9d1-7337-42b0-82ef-1328715100d6","name":"Get Outbound Messages Without Recipient UUID","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b350f632-7685-4337-a3ee-69842964341b","leftValue":"={{ $json.signal_source_uuid }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}},{"id":"ec6cac67-f576-491b-b0c8-b388380cb7f0","leftValue":"={{ $json.signal_source_uuid }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-300,-180],"id":"e4c31138-78a8-4fd2-8302-572300677354","name":"Does Signal UUID Exist?"},{"parameters":{"operation":"update","tableId":"signal_messages","filters":{"conditions":[{"keyName":"id","condition":"eq","keyValue":"={{ $('Get Outbound Messages Without Recipient UUID').item.json.id }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"recipient_uuid","fieldValue":"={{ $json.signal_source_uuid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-80,-180],"id":"171f017f-cd3b-4253-8dc3-026ce1c7e842","name":"Update Signal Message","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"operation":"getAll","tableId":"signal_messages","matchType":"allFilters","filters":{"conditions":[{"keyName":"direction","condition":"eq","keyValue":"inbound"},{"keyName":"sender_phone","condition":"is","keyValue":"={{ null }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-740,20],"id":"c1db329a-8477-471f-9b0e-5b356fb5e938","name":"Get Inbound Messages Without Sender Phone","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"operation":"get","tableId":"users","filters":{"conditions":[{"keyName":"phone_number","keyValue":"={{ $json.recipient_phone }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-520,-180],"id":"52383692-62d4-4b6c-a8e6-16e639e36284","name":"Get User by Phone","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"operation":"get","tableId":"users","filters":{"conditions":[{"keyName":"signal_source_uuid","keyValue":"={{ $json.sender_uuid }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-520,20],"id":"6c8f1c3f-b2eb-440e-82c9-d427457c103b","name":"Get User by Signal UUID","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b350f632-7685-4337-a3ee-69842964341b","leftValue":"={{ $json.phone }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}},{"id":"ec6cac67-f576-491b-b0c8-b388380cb7f0","leftValue":"={{ $json.phone }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-300,20],"id":"dc9d20a5-1090-400e-be0c-bff0ee2b6052","name":"Does Phone Exist?"},{"parameters":{"operation":"update","tableId":"signal_messages","filters":{"conditions":[{"keyName":"id","condition":"eq","keyValue":"={{ $('Get Inbound Messages Without Sender Phone').item.json.id }}"}]},"fieldsUi":{"fieldValues":[{"fieldId":"sender_phone","fieldValue":"={{ $json.phone }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[-80,20],"id":"dbc07a5b-5e3b-4cec-bc5a-1886870b000e","name":"Update Signal_Message","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"rule":{"interval":[{"field":"minutes"}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-960,-80],"id":"1a3622dc-2182-40b4-8db0-931ab0680c77","name":"Run Every 5 Minutes"}],"connections":{"Get Outbound Messages Without Recipient UUID":{"main":[[{"node":"Get User by Phone","type":"main","index":0}]]},"Does Signal UUID Exist?":{"main":[[{"node":"Update Signal Message","type":"main","index":0}]]},"Get Inbound Messages Without Sender Phone":{"main":[[{"node":"Get User by Signal UUID","type":"main","index":0}]]},"Get User by Phone":{"main":[[{"node":"Does Signal UUID Exist?","type":"main","index":0}]]},"Get User by Signal UUID":{"main":[[{"node":"Does Phone Exist?","type":"main","index":0}]]},"Does Phone Exist?":{"main":[[{"node":"Update Signal_Message","type":"main","index":0}]]},"Run Every 5 Minutes":{"main":[[{"node":"Get Outbound Messages Without Recipient UUID","type":"main","index":0},{"node":"Get Inbound Messages Without Sender Phone","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Run Every 5 Minutes":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"ff437d12-a7e3-4f67-b052-be22f0d0c0c3","triggerCount":1,"shared":[{"createdAt":"2025-07-14T21:37:02.757Z","updatedAt":"2025-07-14T21:37:02.757Z","role":"workflow:owner","workflowId":"rMwwPxGr7goRslXS","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}