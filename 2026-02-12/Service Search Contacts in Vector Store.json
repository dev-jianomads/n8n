{"updatedAt":"2026-01-24T20:30:33.397Z","createdAt":"2026-01-23T20:44:09.459Z","id":"cSi44h1ZEK3gmDmx","name":"Service Search Contacts in Vector Store","active":true,"isArchived":false,"nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[-520,64],"id":"c444eb4c-1819-4b18-abb3-718052dc5a91","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAI account"}}},{"parameters":{"mode":"load","prompt":"={{ $json.body.query }}","topK":5,"options":{"metadata":{"metadataValues":[{"name":"user_id","value":"={{ $json.body.user_id }}"},{"name":"source","value":"google"}]}}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[-592,-160],"id":"d1365146-27dd-45aa-9bdd-27da2be704d5","name":"[Google] Contacts","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"mode":"load","prompt":"={{ $json.body.query }}","topK":5,"options":{"metadata":{"metadataValues":[{"name":"user_id","value":"={{ $json.body.user_id }}"},{"name":"source","value":"conversation"}]}}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[-592,240],"id":"672d78fa-bb2f-4f1b-88ff-3dcc6be80eb1","name":"[Conversation] Contacts","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"assignments":{"assignments":[{"id":"e599b1de-86bc-475c-a2a7-937e9dcde816","name":"pageContent","value":"={{ $json.document.pageContent }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,336],"id":"bfba63e8-6119-460f-9a4c-bd9ef25dc13d","name":"Simplify Output"},{"parameters":{"numberInputs":3},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-240,224],"id":"9a332844-51ae-4dd2-ba3a-0015c0443615","name":"Append"},{"parameters":{"httpMethod":"POST","path":"search-contacts","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-816,240],"id":"49b243c7-bae7-4952-bb9c-b9cec4c65e53","name":"Webhook","webhookId":"458b449a-ce08-45c5-974c-862573b0bb52"},{"parameters":{"mode":"raw","jsonOutput":" {\n    \"document\": {\n      \"pageContent\": \"NONE\",\n      \"metadata\": {}\n    },\n    \"score\": -1\n  }","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-528,432],"id":"f77de525-61a4-435e-9cf3-7d8917eead5e","name":"SENTINEL"},{"parameters":{"aggregate":"aggregateAllItemData","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[-16,240],"id":"ac721405-397f-4611-a7af-d1c2455fedd7","name":"Aggregate"},{"parameters":{"assignments":{"assignments":[{"id":"25be2acb-16ad-4a10-9966-1cadcfd30893","name":"data","value":"={{ $json.data.filter(item => item.score >= 0) }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[208,240],"id":"26f0d63f-c056-451c-b8a2-37da38cb740f","name":"No Dummy Data"},{"parameters":{"fieldToSplitOut":"data","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[432,240],"id":"3c02d33a-a1ba-40f1-9fb5-3722e1510f1d","name":"Split Out","alwaysOutputData":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"1338d1d6-ee30-4b4d-9dab-9d0bb9dc2bce","leftValue":"={{ $json }}","rightValue":"","operator":{"type":"object","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[656,240],"id":"f6dd7633-77a5-4dc6-8a38-c268a29a1461","name":"Empty?"},{"parameters":{"respondWith":"json","responseBody":"{\n  \"data\": []\n}","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.5,"position":[880,144],"id":"30982628-dace-4632-9f3c-3b3d9d82f741","name":"Respond with Data"},{"parameters":{"respondWith":"json","responseBody":"={\n  \"data\": {{ JSON.stringify($input.all().map(item => item.json)) }}\n}","options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.5,"position":[1104,336],"id":"1cb824f6-d17c-41fd-b0dc-4ce024426ca5","name":"Respond with Empty List"}],"connections":{"Embeddings OpenAI":{"ai_embedding":[[{"node":"[Google] Contacts","type":"ai_embedding","index":0},{"node":"[Conversation] Contacts","type":"ai_embedding","index":0}]]},"[Google] Contacts":{"main":[[{"node":"Append","type":"main","index":0}]]},"[Conversation] Contacts":{"main":[[{"node":"Append","type":"main","index":1}]]},"Append":{"main":[[{"node":"Aggregate","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"[Google] Contacts","type":"main","index":0},{"node":"[Conversation] Contacts","type":"main","index":0},{"node":"SENTINEL","type":"main","index":0}]]},"SENTINEL":{"main":[[{"node":"Append","type":"main","index":2}]]},"Aggregate":{"main":[[{"node":"No Dummy Data","type":"main","index":0}]]},"No Dummy Data":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Empty?","type":"main","index":0}]]},"Empty?":{"main":[[{"node":"Respond with Data","type":"main","index":0}],[{"node":"Simplify Output","type":"main","index":0}]]},"Simplify Output":{"main":[[{"node":"Respond with Empty List","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","availableInMCP":false},"staticData":null,"meta":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"n8n.srv845833.hstgr.cloud","user-agent":"PostmanRuntime/7.51.0","content-length":"88","accept":"*/*","accept-encoding":"gzip, deflate, br","content-type":"application/json","postman-token":"f10f789f-f2bb-4652-96bc-8dd7b2b3036c","x-forwarded-for":"179.32.69.121","x-forwarded-host":"n8n.srv845833.hstgr.cloud","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"0b78dbd8128d","x-real-ip":"179.32.69.121"},"params":{},"query":{},"body":{"user_id":"Rpyn89tYSO4FBo3uyTeXJ4Pyzspg","query":"Sumit Malhotra"},"webhookUrl":"https://n8n.srv845833.hstgr.cloud/webhook/search-contacts","executionMode":"production"},"pairedItem":{"item":0}}]},"versionId":"24d259c7-cf21-4650-91f2-2c274ee73d20","activeVersionId":"24d259c7-cf21-4650-91f2-2c274ee73d20","triggerCount":1,"shared":[{"updatedAt":"2026-01-23T20:44:09.459Z","createdAt":"2026-01-23T20:44:09.459Z","role":"workflow:owner","workflowId":"cSi44h1ZEK3gmDmx","projectId":"8nyfoRCh3nEYWaKJ"}],"activeVersion":{"updatedAt":"2026-01-24T20:30:34.730Z","createdAt":"2026-01-24T20:30:33.398Z","versionId":"24d259c7-cf21-4650-91f2-2c274ee73d20","workflowId":"cSi44h1ZEK3gmDmx","nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[-520,64],"id":"c444eb4c-1819-4b18-abb3-718052dc5a91","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAI account"}}},{"parameters":{"mode":"load","prompt":"={{ $json.body.query }}","topK":5,"options":{"metadata":{"metadataValues":[{"name":"user_id","value":"={{ $json.body.user_id }}"},{"name":"source","value":"google"}]}}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[-592,-160],"id":"d1365146-27dd-45aa-9bdd-27da2be704d5","name":"[Google] Contacts","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"mode":"load","prompt":"={{ $json.body.query }}","topK":5,"options":{"metadata":{"metadataValues":[{"name":"user_id","value":"={{ $json.body.user_id }}"},{"name":"source","value":"conversation"}]}}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[-592,240],"id":"672d78fa-bb2f-4f1b-88ff-3dcc6be80eb1","name":"[Conversation] Contacts","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"assignments":{"assignments":[{"id":"e599b1de-86bc-475c-a2a7-937e9dcde816","name":"pageContent","value":"={{ $json.document.pageContent }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,336],"id":"bfba63e8-6119-460f-9a4c-bd9ef25dc13d","name":"Simplify Output"},{"parameters":{"numberInputs":3},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-240,224],"id":"9a332844-51ae-4dd2-ba3a-0015c0443615","name":"Append"},{"parameters":{"httpMethod":"POST","path":"search-contacts","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-816,240],"id":"49b243c7-bae7-4952-bb9c-b9cec4c65e53","name":"Webhook","webhookId":"458b449a-ce08-45c5-974c-862573b0bb52"},{"parameters":{"mode":"raw","jsonOutput":" {\n    \"document\": {\n      \"pageContent\": \"NONE\",\n      \"metadata\": {}\n    },\n    \"score\": -1\n  }","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-528,432],"id":"f77de525-61a4-435e-9cf3-7d8917eead5e","name":"SENTINEL"},{"parameters":{"aggregate":"aggregateAllItemData","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[-16,240],"id":"ac721405-397f-4611-a7af-d1c2455fedd7","name":"Aggregate"},{"parameters":{"assignments":{"assignments":[{"id":"25be2acb-16ad-4a10-9966-1cadcfd30893","name":"data","value":"={{ $json.data.filter(item => item.score >= 0) }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[208,240],"id":"26f0d63f-c056-451c-b8a2-37da38cb740f","name":"No Dummy Data"},{"parameters":{"fieldToSplitOut":"data","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[432,240],"id":"3c02d33a-a1ba-40f1-9fb5-3722e1510f1d","name":"Split Out","alwaysOutputData":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"1338d1d6-ee30-4b4d-9dab-9d0bb9dc2bce","leftValue":"={{ $json }}","rightValue":"","operator":{"type":"object","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[656,240],"id":"f6dd7633-77a5-4dc6-8a38-c268a29a1461","name":"Empty?"},{"parameters":{"respondWith":"json","responseBody":"{\n  \"data\": []\n}","options":{"responseCode":200}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.5,"position":[880,144],"id":"30982628-dace-4632-9f3c-3b3d9d82f741","name":"Respond with Data"},{"parameters":{"respondWith":"json","responseBody":"={\n  \"data\": {{ JSON.stringify($input.all().map(item => item.json)) }}\n}","options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.5,"position":[1104,336],"id":"1cb824f6-d17c-41fd-b0dc-4ce024426ca5","name":"Respond with Empty List"}],"connections":{"Embeddings OpenAI":{"ai_embedding":[[{"node":"[Google] Contacts","type":"ai_embedding","index":0},{"node":"[Conversation] Contacts","type":"ai_embedding","index":0}]]},"[Google] Contacts":{"main":[[{"node":"Append","type":"main","index":0}]]},"[Conversation] Contacts":{"main":[[{"node":"Append","type":"main","index":1}]]},"Append":{"main":[[{"node":"Aggregate","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"[Google] Contacts","type":"main","index":0},{"node":"[Conversation] Contacts","type":"main","index":0},{"node":"SENTINEL","type":"main","index":0}]]},"SENTINEL":{"main":[[{"node":"Append","type":"main","index":2}]]},"Aggregate":{"main":[[{"node":"No Dummy Data","type":"main","index":0}]]},"No Dummy Data":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Empty?","type":"main","index":0}]]},"Empty?":{"main":[[{"node":"Respond with Data","type":"main","index":0}],[{"node":"Simplify Output","type":"main","index":0}]]},"Simplify Output":{"main":[[{"node":"Respond with Empty List","type":"main","index":0}]]}},"authors":"Dev JIA","name":"Version 24d259c7","description":"","autosaved":false},"tags":[]}