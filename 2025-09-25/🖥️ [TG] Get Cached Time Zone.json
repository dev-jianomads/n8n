{"createdAt":"2025-08-28T21:47:44.283Z","updatedAt":"2025-09-25T20:48:10.512Z","id":"9jeZuQfIDYEe9f5u","name":"üñ•Ô∏è [TG] Get Cached Time Zone","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"telegramId"},{"name":"userId"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-128,-48],"id":"37a82f6d-9b3e-4d5e-a9e4-7f81d78047d4","name":"When Executed by Another Workflow"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"3f30d3a0-7e86-41ad-885a-f6a43f9665a1","leftValue":"={{ $json.timeZone }}","rightValue":"","operator":{"type":"string","operation":"notExists","singleValue":true}},{"id":"db212835-39e0-47fd-8ad7-a0151a408f87","leftValue":"={{ $json.timeZone }}","rightValue":"","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"or"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[320,-48],"id":"9f82ad62-a828-43fc-ae25-31015e548b07","name":"Does Not Exist?"},{"parameters":{"operation":"get","propertyName":"timeZone","key":"={{ $json.telegramId }}_TZ_DEV","options":{"dotNotation":true}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[96,-48],"id":"1f69cb44-658d-4a40-87c9-738d29c7a703","name":"Get Cached Time Zone","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"workflowId":{"__rl":true,"value":"IOSFHvzzfnVGmNZr","mode":"list","cachedResultUrl":"/workflow/IOSFHvzzfnVGmNZr","cachedResultName":"üñ•Ô∏è [TG] Get Cached Conversation"},"workflowInputs":{"mappingMode":"defineBelow","value":{"telegramId":"={{ $('When Executed by Another Workflow').item.json.telegramId }}"},"matchingColumns":["telegramId"],"schema":[{"id":"telegramId","displayName":"telegramId","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":true},"mode":"each","options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[544,-112],"id":"39c7dc81-183d-465d-a8c3-797636dda646","name":"Get Chat History"},{"parameters":{"workflowId":{"__rl":true,"value":"DHcoEXUvqWWKxbZD","mode":"list","cachedResultUrl":"/workflow/DHcoEXUvqWWKxbZD","cachedResultName":"üñ•Ô∏è [TG] Get Time Zone"},"workflowInputs":{"mappingMode":"defineBelow","value":{"chatHistory":"={{ $json.chatHistory }}","userId":"={{ $('When Executed by Another Workflow').item.json.userId }}"},"matchingColumns":[],"schema":[{"id":"userId","displayName":"userId","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"},{"id":"chatHistory","displayName":"chatHistory","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"array"},{"id":"currentTimeZone","displayName":"currentTimeZone","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[768,-112],"id":"d2bfb287-b0a5-4c71-afba-27bb71403fba","name":"Compute Time Zone"},{"parameters":{"assignments":{"assignments":[{"id":"29ad7c76-3dcb-4e2b-9f4f-3d52f99bb65b","name":"timeZone","value":"={{ $json.timeZone }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[992,-32],"id":"101277fc-c017-4450-ba68-10259f86afc9","name":"Unify Time Zone"},{"parameters":{"url":"=https://api.getzep.com/api/v2/threads/{{ $('When Executed by Another Workflow').item.json.telegramId }}/context","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Api-Key z_1dWlkIjoiZmU5YzUwZTAtMzQ4My00MDVkLTgwOGYtZmFiZTk2OTBiYTIyIn0.nyE2K_HjSx2yXEKe4zrNy3Yx8cGPLp61CykdyEsTWu0wkXbDj7o_ZTt7JiMxEjkv_kfFQdtlcykDuVY2d6Niug"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[624,-240],"id":"4e8643dc-b8a3-4fe1-917b-5820d735bbda","name":"Get Context"}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Get Cached Time Zone","type":"main","index":0}]]},"Does Not Exist?":{"main":[[{"node":"Get Chat History","type":"main","index":0}],[{"node":"Unify Time Zone","type":"main","index":0}]]},"Get Cached Time Zone":{"main":[[{"node":"Does Not Exist?","type":"main","index":0}]]},"Get Chat History":{"main":[[{"node":"Compute Time Zone","type":"main","index":0}]]},"Compute Time Zone":{"main":[[{"node":"Unify Time Zone","type":"main","index":0}]]},"Unify Time Zone":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"telegramId":"1598386791","userId":"d24503d6-48da-4af1-8599-177cd8501341"}}]},"versionId":"c43c29a8-e13e-4f73-9a51-48ad9feffebc","triggerCount":0,"shared":[{"createdAt":"2025-08-28T21:47:44.283Z","updatedAt":"2025-08-28T21:47:44.283Z","role":"workflow:owner","workflowId":"9jeZuQfIDYEe9f5u","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}