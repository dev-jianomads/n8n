{"updatedAt":"2025-11-04T16:46:39.297Z","createdAt":"2025-11-04T16:46:21.259Z","id":"5S5xSdEz7LBpHCab","name":"[WA] Search Contacts","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"userId"},{"name":"query"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[0,320],"id":"41f6f05c-449c-4eb8-b6b2-8391f248c7d5","name":"When Executed by Another Workflow"},{"parameters":{"workflowId":{"__rl":true,"value":"pE2lsrstziYiLtF8","mode":"list","cachedResultName":"Get Token for TG Integration"},"workflowInputs":{"mappingMode":"defineBelow","value":{"user_id":"={{ $json.userId }}"},"matchingColumns":["user_id"],"schema":[{"id":"user_id","displayName":"user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[224,320],"id":"0651f0a9-48ef-44d4-b771-99921162861a","name":"Get Token"},{"parameters":{"url":"=https://people.googleapis.com/v1/people:searchContacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $('When Executed by Another Workflow').item.json.query }}"},{"name":"readMask","value":"names,emailAddresses"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.accessToken }}"},{"name":"Content-Type","value":"application/json"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[448,320],"id":"19dabe48-713c-49dd-acaa-5ad6c2cd7d7a","name":"Search Contacts","retryOnFail":true,"alwaysOutputData":false,"onError":"continueErrorOutput"},{"parameters":{"jsonSchemaExample":"{\n  \"results\": [\n    {\"fullName\": \"Ken Wong\",\n      \"email\": \"ken@jia-nomads.com\",\n      \"number\": 1\n    },\n    {\n      \"fullName\": \"Ken Dad HK\",\n      \"email\": null,\n      \"number\": 2\n    }\n  ]\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[896,128],"id":"fec19cdb-5ba6-40a7-b222-a80697d3b9e9","name":"Structured Output Parser"},{"parameters":{"options":{"temperature":0}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[720,128],"id":"94807b1e-9976-4fc7-bec2-b93a6ef9bb28","name":"4.1 Mini","credentials":{"openRouterApi":{"id":"SeBKTiKFu0nP1GsL","name":"OpenRouter account"}}},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{"temperature":0}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[896,336],"id":"cd9c3ba4-51cd-4db0-b8e3-fe926f574536","name":"4.1_mini","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAI account"}}},{"parameters":{"promptType":"define","text":"=Take the results from Google Contact's API, and create a simplified JSON list with:\n- Contact Full Name.\n- Contact Email.\n- Number (the number of the contact in the list of results)\n\n## Input:\n{{ JSON.stringify($json.results) }}","hasOutputParser":true,"needsFallback":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[672,-96],"id":"46486d7e-0c76-4c82-8bbf-1ba6924bb401","name":"Output Formatter"},{"parameters":{"assignments":{"assignments":[{"id":"7ac574f1-cccb-426d-b676-5b9446410a0d","name":"response","value":"=There was an error: {{ JSON.stringify($json) }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,512],"id":"97c3ea06-d3ac-4490-9413-e012f30815f8","name":"Error Response"},{"parameters":{"assignments":{"assignments":[{"id":"15d523a5-eab8-482c-9342-58e06eb3af35","name":"response","value":"={{$json.output.results.map(r => r.number + \". Full Name: \" + r.fullName + \"\\n  Email: \" + r.email).join(\"\\n\\n\")}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1296,112],"id":"41d319fe-c4dd-43c3-a792-1f79330f74d1","name":"Successful Response"},{"parameters":{"url":"=https://people.googleapis.com/v1/otherContacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"readMask","value":"names,emailAddresses"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.accessToken }}"},{"name":"Content-Type","value":"application/json"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[0,736],"id":"d855d53c-7cad-4ad5-ac3b-2f762052f539","name":"Search Contacts1","retryOnFail":true,"alwaysOutputData":false,"disabled":true,"onError":"continueErrorOutput"}],"connections":{"Get Token":{"main":[[{"node":"Search Contacts","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Get Token","type":"main","index":0}]]},"Search Contacts":{"main":[[{"node":"Output Formatter","type":"main","index":0}],[{"node":"Error Response","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Output Formatter","type":"ai_outputParser","index":0}]]},"4.1 Mini":{"ai_languageModel":[[{"node":"Output Formatter","type":"ai_languageModel","index":0}]]},"4.1_mini":{"ai_languageModel":[[{"node":"Output Formatter","type":"ai_languageModel","index":1},{"node":"Structured Output Parser","type":"ai_languageModel","index":0}]]},"Output Formatter":{"main":[[{"node":"Successful Response","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Search Contacts":[{"json":{"results":[{"person":{"resourceName":"people/c1467631864186137506","etag":"%EgcBAgkuNz0+GgECIgwvTk8zc0NsQm1XST0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"145e136795dbeba2"},"sourcePrimary":true},"displayName":"Ken Dad HK","givenName":"Ken Dad HK","displayNameLastFirst":"Ken Dad HK","unstructuredName":"Ken Dad HK"}]}},{"person":{"resourceName":"people/c5312739810180299075","etag":"%EgcBAgkuNz0+GgECIgxFYkdQaTA1ZlFqQT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"49baa4b591df7943"},"sourcePrimary":true},"displayName":"Ken Wong","familyName":"Wong","givenName":"Ken","displayNameLastFirst":"Wong, Ken","unstructuredName":"Ken Wong"}]}},{"person":{"resourceName":"people/c5370861444361165055","etag":"%EgcBAgkuNz0+GgECIgxhbE9zUCtRRG1BQT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"4a89220710fd18ff"},"sourcePrimary":true},"displayName":"Ken_冷氣清洗","givenName":"Ken_冷氣清洗","displayNameLastFirst":"Ken_冷氣清洗","unstructuredName":"Ken_冷氣清洗"}]}},{"person":{"resourceName":"people/c7078635452459776502","etag":"%EgcBAgkuNz0+GgECIgxDM2E0SU1YTHZ4bz0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"623c5d709659f9f6"},"sourcePrimary":true},"displayName":"Kennies-shop","givenName":"Kennies-shop","displayNameLastFirst":"Kennies-shop","unstructuredName":"Kennies-shop"}]}},{"person":{"resourceName":"people/c641478538677446606","etag":"%EgcBAgkuNz0+GgECIgwvUkN4OGVqTitWUT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"8e6fd550ce7e7ce"},"sourcePrimary":true},"displayName":"Carmen Ken","familyName":"Ken","givenName":"Carmen","displayNameLastFirst":"Ken, Carmen","unstructuredName":"Carmen Ken"}]}}]}}],"When Executed by Another Workflow":[{"json":{"userId":"0HpJe5sETk3z9thjekbyzmfSX5Fo","query":"ken"}}]},"versionId":"0990bab5-0c65-45fc-9673-bc497f5f0ce3","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-11-04T16:46:21.259Z","createdAt":"2025-11-04T16:46:21.259Z","role":"workflow:owner","workflowId":"5S5xSdEz7LBpHCab","projectId":"8nyfoRCh3nEYWaKJ"}],"activeVersion":null,"tags":[]}