{"updatedAt":"2025-11-23T21:41:08.923Z","createdAt":"2025-11-20T20:52:53.162Z","id":"dl7Ouu4fFql85VAB","name":"[Slack] Send Message","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"slack_user_id"},{"name":"text"},{"name":"save","type":"boolean"},{"name":"tool_activity","type":"array"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-208,-80],"id":"f7bc0e3c-1853-430f-952f-5db34427b341","name":"When Executed by Another Workflow"},{"parameters":{"method":"POST","url":"https://slack.com/api/chat.postMessage","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.get_slack_token.token }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"channel","value":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}"},{"name":"text","value":"={{ $('When Executed by Another Workflow').item.json.text }}"},{"name":"unfurl_links","value":"true"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[464,-80],"id":"80dad66e-c0dd-4819-9fa4-a0841a9fb78e","name":"Send Message"},{"parameters":{"operation":"executeQuery","query":"SELECT get_user_id_by_slack_user_id('{{ $json.slack_user_id }}');","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[16,-80],"id":"b9735325-5458-4ee5-b1ea-e0e7e3b36f1a","name":"Get Tomo User by Slack User ID","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"operation":"executeQuery","query":"SELECT get_slack_token('{{ $json.get_user_id_by_slack_user_id }}');","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[240,-80],"id":"0c79f586-ccc7-40e9-ac3d-44d8ef219d7a","name":"Get Slack Token","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"2d4116ee-b07a-4170-8338-d8b16d62f445","leftValue":"={{ $('When Executed by Another Workflow').item.json.save }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[688,-80],"id":"4b63c81f-68bf-43ae-ad51-414731ebec74","name":"Save?"},{"parameters":{"assignments":{"assignments":[{"id":"994defb3-f232-4a03-a0c8-248ff454b522","name":"timestampUTC","value":"={{ $now.toDateTime('s').toUTC().toISO() }}","type":"string"},{"id":"d4e09809-2917-4c71-af40-f0350588e22c","name":"date","value":"={{ $now.toSeconds().round()}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[912,-176],"id":"a47b38e9-5093-4820-81a6-e3a21b2bbad8","name":"Parse Timestamp & Consolidate TG Data"},{"parameters":{"tableId":"slack_messages","fieldsUi":{"fieldValues":[{"fieldId":"slack_team_id","fieldValue":"={{ $('Send Message').item.json.message.team }}"},{"fieldId":"slack_channel_id","fieldValue":"={{ $('Send Message').item.json.channel }}"},{"fieldId":"slack_user_id","fieldValue":"={{ $('Send Message').item.json.message.user }}"},{"fieldId":"slack_message_ts","fieldValue":"={{ $('Send Message').item.json.ts }}"},{"fieldId":"slack_message_ts_utc","fieldValue":"={{ $json.timestampUTC }}"},{"fieldId":"direction","fieldValue":"outbound"},{"fieldId":"raw_payload","fieldValue":"={{ $('Send Message').item.json }}"},{"fieldId":"text","fieldValue":"={{ $('Send Message').item.json.message.text }}"},{"fieldId":"sender_id","fieldValue":"={{ $('Send Message').item.json.message.user }}"},{"fieldId":"recipient_id","fieldValue":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}"},{"fieldId":"tool_activity","fieldValue":"={{ $('When Executed by Another Workflow').item.json.tool_activity ?? [] }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[1136,-176],"id":"b30f7c9e-ed2a-4967-8a6e-b1a8bb935bcc","name":"Save Message","retryOnFail":true,"credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[912,16],"id":"724bc959-9f06-4dbb-964f-b3c180fb4f7a","name":"No Operation, do nothing"}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Get Tomo User by Slack User ID","type":"main","index":0}]]},"Get Tomo User by Slack User ID":{"main":[[{"node":"Get Slack Token","type":"main","index":0}]]},"Get Slack Token":{"main":[[{"node":"Send Message","type":"main","index":0}]]},"Send Message":{"main":[[{"node":"Save?","type":"main","index":0}]]},"Parse Timestamp & Consolidate TG Data":{"main":[[{"node":"Save Message","type":"main","index":0}]]},"Save?":{"main":[[{"node":"Parse Timestamp & Consolidate TG Data","type":"main","index":0}],[{"node":"No Operation, do nothing","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"slack_user_id":"U07U3MJ9SQY","text":"_Thinking_ :brain:","save":false,"tool_activity":[]}}]},"versionId":"b54f84f9-3520-499a-8962-0bab2d8b60fd","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-11-20T20:52:53.162Z","createdAt":"2025-11-20T20:52:53.162Z","role":"workflow:owner","workflowId":"dl7Ouu4fFql85VAB","projectId":"8nyfoRCh3nEYWaKJ"}],"activeVersion":null,"tags":[]}