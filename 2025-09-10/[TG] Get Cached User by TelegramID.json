{"createdAt":"2025-08-27T21:47:08.355Z","updatedAt":"2025-08-27T21:56:14.950Z","id":"G7zoduW2QwUQ0lF6","name":"[TG] Get Cached User by TelegramID","active":false,"isArchived":false,"nodes":[{"parameters":{"operation":"get","tableId":"users","filters":{"conditions":[{"keyName":"telegram_id","keyValue":"={{ $('Start').item.json.telegramId }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[976,-624],"id":"2038acb3-29ef-4b3a-90ab-1e18bda30951","name":"Get User","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"workflowInputs":{"values":[{"name":"telegramId","type":"number"}]}},"id":"977d2154-a713-4244-9190-79b328c18120","typeVersion":1.1,"name":"Start","type":"n8n-nodes-base.executeWorkflowTrigger","position":[304,-720]},{"parameters":{"operation":"get","propertyName":"user","key":"={{ $json.telegramId }}_USER","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[528,-720],"id":"63a1b690-06de-4094-b758-4ccc20826911","name":"Get Cached User","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f07b4a16-6b8e-4726-a150-11e59297c0b4","leftValue":"={{ $json.user }}","rightValue":"","operator":{"type":"string","operation":"exists","singleValue":true}},{"id":"7d37698f-df1f-4ba9-ab0d-57fd172a7f22","leftValue":"={{ $json.user }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[752,-720],"id":"71d29f88-e7f0-49cf-aefb-3f68b5ea695d","name":"Exists?"},{"parameters":{"operation":"set","key":"={{ $('Start').item.json.telegramId }}_USER","value":"={{ JSON.stringify($json) }}","expire":true,"ttl":"={{ 1 * 24 * 60 * 60 }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[1200,-720],"id":"c0b75913-f0ed-4d17-8c5d-9d135b3956ac","name":"Cache User","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"mode":"chooseBranch","useDataOfInput":2},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1424,-624],"id":"9603ddbe-208f-46e0-8c57-443c05b4282d","name":"Merge"},{"parameters":{"mode":"raw","jsonOutput":"={{ JSON.parse($json.user) }}","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[976,-816],"id":"7708d8f6-6821-4ca7-948d-c87a3e3ee37d","name":"Set User"}],"connections":{"Start":{"main":[[{"node":"Get Cached User","type":"main","index":0}]]},"Get User":{"main":[[{"node":"Cache User","type":"main","index":0},{"node":"Merge","type":"main","index":1}]]},"Get Cached User":{"main":[[{"node":"Exists?","type":"main","index":0}]]},"Exists?":{"main":[[{"node":"Set User","type":"main","index":0}],[{"node":"Get User","type":"main","index":0}]]},"Cache User":{"main":[[{"node":"Merge","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Start":[{"json":{"telegramId":1598386790}}]},"versionId":"f9b12b3d-5aed-4bea-abdf-16c65f42e806","triggerCount":0,"shared":[{"createdAt":"2025-08-27T21:47:08.355Z","updatedAt":"2025-08-27T21:47:08.355Z","role":"workflow:owner","workflowId":"G7zoduW2QwUQ0lF6","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}