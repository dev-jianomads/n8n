{"createdAt":"2025-05-29T16:20:45.632Z","updatedAt":"2025-05-29T19:46:01.721Z","id":"Vg55A0mxC7AIO0xQ","name":"ðŸ¤– Merge Tasks","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"tasks","type":"array"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-120,-140],"id":"c8d6108d-e467-4667-9b8f-b63759224d91","name":"When Executed by Another Workflow"},{"parameters":{"assignments":{"assignments":[{"id":"49b0007a-0165-4e12-833f-fc1d04abf1a1","name":"tasks","value":"={{ $json.output }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[480,-140],"id":"882ad1d4-71fe-44a9-a451-765a93f09811","name":"Edit Fields"},{"parameters":{"jsonSchemaExample":"[\n  {\n    \"description\": \"Prepare and send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[420,80],"id":"c331180d-7d2b-4935-8b42-9efb7dc3ed7a","name":"Structured Output Parser"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{"maxTokens":-1,"temperature":0.5}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[0,60],"id":"927fb5df-e3a3-4f78-85a5-ff170987de66","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAi account"}}},{"parameters":{"promptType":"define","text":"={{ JSON.stringify($json.tasks) }}","hasOutputParser":true,"options":{"systemMessage":"You are an AI agent tasked with analyzing lists of tasks extracted from emails. Your job is to identify tasks that are very similar or closely related and combine them into a single, clear task when appropriate.\n\n**Categories are limited to:** `EVENT`, `REPLY`, `REVIEW`, or `APP`.\n\n### Criteria for combination:\n\n- Tasks have similar descriptions or clearly overlap.\n- Tasks share the same or very similar due dates, priorities, or categories.\n\n### When combining tasks:\n\n- **Description:** Concisely merge descriptions into a single clear action.\n- **Priority:** Use the highest priority among combined tasks (`high` > `medium` > `low`).\n- **Due date:** Use the earliest clearly specified due date.\n- **Category:** Maintain the most relevant common category.\n\nIf no tasks logically require combining, do **not** alter them.\n\n---\n\n### Example Input (should combine):\n\n```json\n[\n  {\n    \"description\": \"Send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-10\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Prepare app report update\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]\n```\n\n### Example Output (combined):\n\n```json\n[\n  {\n    \"description\": \"Prepare and send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]\n```\n\n---\n\n### Example Input (no combination):\n\n```json\n[\n  {\n    \"description\": \"Reply to client's question about billing\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-12\",\n    \"category\": \"REPLY\"\n  },\n  {\n    \"description\": \"Review team's project milestones\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-14\",\n    \"category\": \"REVIEW\"\n  }\n]\n```\n\n### Example Output (unchanged):\n\n```json\n[\n  {\n    \"description\": \"Reply to client's question about billing\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-12\",\n    \"category\": \"REPLY\"\n  },\n  {\n    \"description\": \"Review team's project milestones\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-14\",\n    \"category\": \"REVIEW\"\n  }\n]\n```\n\n---\n\nYour response must always and ONLY be a JSON array of tasks following the structure above."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[100,-120],"id":"ed5ab5b7-d20b-49da-9eb5-aa6100bb40c1","name":"Task Merger"}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Task Merger","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Task Merger","type":"ai_outputParser","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Task Merger","type":"ai_languageModel","index":0}]]},"Task Merger":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"63JMaA3ATIsJVc6Y"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"8da185a7-c7fc-456b-abd2-9f15bd5b593c","triggerCount":0,"tags":[]}