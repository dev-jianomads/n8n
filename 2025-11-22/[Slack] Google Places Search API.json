{"updatedAt":"2025-11-22T22:10:37.785Z","createdAt":"2025-11-22T21:56:58.308Z","id":"GfIHrNUR5C561U2N","name":"[Slack] Google Places Search API","active":false,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"https://places.googleapis.com/v1/places:searchText","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Goog-Api-Key","value":"AIzaSyBpFjB5LAjnIUVf7ZyGSIQ4NWnLjgepcoM"},{"name":"X-Goog-FieldMask","value":"places.displayName,places.formattedAddress,places.photos,places.rating,places.googleMapsUri,places.websiteUri"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"textQuery","value":"={{ $('When Executed by Another Workflow').item.json.query }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-2208,96],"id":"14fcde12-d41c-43f5-8e60-cf116f873722","name":"Search Places","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"workflowInputs":{"values":[{"name":"query"},{"name":"whatsAppId"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-2432,96],"id":"73c1c352-395a-4b1c-91fb-060dcb218219","name":"When Executed by Another Workflow"},{"parameters":{"fieldToSplitOut":"places","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-1984,32],"id":"7a6433a8-f1d6-4139-a8e8-0595bf1a90d4","name":"Split Out"},{"parameters":{"maxItems":3},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[-1312,32],"id":"313c069f-0a16-4371-bf6e-f23e0a3030fc","name":"Limit"},{"parameters":{"tableId":"whatsapp_messages","fieldsUi":{"fieldValues":[{"fieldId":"whatsapp_date","fieldValue":"={{ $now.toSeconds().round() }}"},{"fieldId":"whatsapp_date_utc","fieldValue":"={{ $now.toDateTime('s').toUTC().toISO() }}"},{"fieldId":"text","fieldValue":"={{$('Set Params').item.json.caption }}"},{"fieldId":"direction","fieldValue":"outbound"},{"fieldId":"sender_id","fieldValue":"={{ $('Set Params').item.json.tomoWhatsAppId }}"},{"fieldId":"recipient_id","fieldValue":"={{ $('When Executed by Another Workflow').item.json.whatsAppId }}"},{"fieldId":"whatsapp_message_id","fieldValue":"={{ $('Send message').item.json.messages[0].id }}"}]}},"type":"n8n-nodes-base.supabase","typeVersion":1,"position":[16,-16],"id":"95415fb8-19c9-4dd4-8671-04f7c3ae23af","name":"Save Message","credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}},{"parameters":{"assignments":{"assignments":[{"id":"4c47c47f-daf9-401c-9148-42e5e00bdcf9","name":"response","value":"={{ $json.concatenated_text }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[688,-16],"id":"8ee29def-53c7-4ef0-be72-a595eb88c2ed","name":"Set Successful Response","executeOnce":true},{"parameters":{"assignments":{"assignments":[{"id":"6587096c-e9d7-498e-a8f9-374befde1b85","name":"response","value":"There was a problem searching for places.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-864,192],"id":"f2e26016-1cbb-4fe7-ae14-53495bd37045","name":"Set Error Response"},{"parameters":{"fieldsToSummarize":{"values":[{"aggregation":"concatenate","field":"text","separateBy":"other","customSeparator":"\\n---\\n"}]},"options":{}},"type":"n8n-nodes-base.summarize","typeVersion":1.1,"position":[240,-112],"id":"c62b08cb-6406-44e2-806b-cb8f382c32b2","name":"Concatenate Options"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0b436d84-0f54-49c9-a0ef-ca5f9d07a4c4","leftValue":"={{ $json.rating }}","rightValue":4.5,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[-1760,32],"id":"6c4840a3-9439-4fb6-bd55-848ccd0d06ee","name":"Filter"},{"parameters":{"type":"random"},"type":"n8n-nodes-base.sort","typeVersion":1,"position":[-1536,32],"id":"51775905-8ca2-4ab8-be89-3162e17632ef","name":"Randomize"},{"parameters":{"assignments":{"assignments":[{"id":"2bc3e4f7-6d56-495c-addb-2fcd8543c051","name":"=caption","value":"=Option #{{ $itemIndex + 1 }}: *{{$('Limit').item.json.displayName.text}}*  \n\nLink: {{$('Limit').item.json.googleMapsUri}} \nRating: {{ $('Limit').item.json.rating }} \nAddress: {{ $('Limit').item.json.formattedAddress }}","type":"string"},{"id":"ca1a3a8e-35a5-4780-9715-58dfac511b4c","name":"tomoWhatsAppId","value":"15551366684","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1072,32],"id":"6ee172a3-db66-45da-9e98-16926fc03d02","name":"Set Params"},{"parameters":{"resource":"media","operation":"mediaDelete","mediaDeleteId":"={{ $('Set Params').item.json.id }}"},"type":"n8n-nodes-base.whatsApp","typeVersion":1.1,"position":[240,80],"id":"12e10710-f998-4745-9855-28332e6c2628","name":"Delete media","webhookId":"66a24dbb-5c05-4c52-aab3-45efb65c3701","credentials":{"whatsAppApi":{"id":"hn7HYT0djID7QTau","name":"WhatsApp account"}},"onError":"continueRegularOutput"},{"parameters":{"mode":"chooseBranch"},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[464,-16],"id":"34c3cd83-7f4b-48d8-8ff8-26b234fbe1e3","name":"Merge"},{"parameters":{"workflowId":{"__rl":true,"value":"dl7Ouu4fFql85VAB","mode":"list","cachedResultUrl":"/workflow/dl7Ouu4fFql85VAB","cachedResultName":"[Slack] Send Message"},"workflowInputs":{"mappingMode":"defineBelow","value":{"text":"={{ $json.caption }}","slack_user_id":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}"},"matchingColumns":[],"schema":[{"id":"slack_user_id","displayName":"slack_user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"text","displayName":"text","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"save","displayName":"save","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"boolean","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[-864,32],"id":"e4cd4f2e-312c-4f19-9f95-6bc4e9dc5420","name":"Call '[Slack] Send Message'"}],"connections":{"Search Places":{"main":[[{"node":"Split Out","type":"main","index":0}],[{"node":"Set Error Response","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Search Places","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Limit":{"main":[[{"node":"Set Params","type":"main","index":0}]]},"Save Message":{"main":[[{"node":"Concatenate Options","type":"main","index":0},{"node":"Delete media","type":"main","index":0}]]},"Concatenate Options":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Randomize","type":"main","index":0}]]},"Randomize":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Set Params":{"main":[[{"node":"Call '[Slack] Send Message'","type":"main","index":0}]]},"Delete media":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"Set Successful Response","type":"main","index":0}]]},"Call '[Slack] Send Message'":{"main":[[{"node":"Save Message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"When Executed by Another Workflow":[{"json":{"query":"cool restaurants in Usaquén, Bogotá","slack_user_id":"U07U3MJ9SQY"}}]},"versionId":"1592b2dd-fddc-450a-aa2f-8c303bc3d50a","triggerCount":0,"shared":[{"updatedAt":"2025-11-22T21:56:58.308Z","createdAt":"2025-11-22T21:56:58.308Z","role":"workflow:owner","workflowId":"GfIHrNUR5C561U2N","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}