{"updatedAt":"2025-11-26T22:16:19.372Z","createdAt":"2025-11-22T21:56:58.308Z","id":"GfIHrNUR5C561U2N","name":"[Slack] Google Places Search API","active":false,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"https://places.googleapis.com/v1/places:searchText","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Goog-Api-Key","value":"AIzaSyBpFjB5LAjnIUVf7ZyGSIQ4NWnLjgepcoM"},{"name":"X-Goog-FieldMask","value":"places.displayName,places.formattedAddress,places.photos,places.rating,places.googleMapsUri,places.websiteUri"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"textQuery","value":"={{ $('When Executed by Another Workflow').item.json.query }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1984,-176],"id":"14fcde12-d41c-43f5-8e60-cf116f873722","name":"Search Places","retryOnFail":true,"onError":"continueErrorOutput"},{"parameters":{"workflowInputs":{"values":[{"name":"query"},{"name":"slack_user_id"},{"name":"channel_id"},{"name":"message_ts"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-2432,-176],"id":"73c1c352-395a-4b1c-91fb-060dcb218219","name":"When Executed by Another Workflow"},{"parameters":{"fieldToSplitOut":"places","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-1760,-272],"id":"7a6433a8-f1d6-4139-a8e8-0595bf1a90d4","name":"Split Out"},{"parameters":{"maxItems":3},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[-1088,-272],"id":"313c069f-0a16-4371-bf6e-f23e0a3030fc","name":"Limit"},{"parameters":{"assignments":{"assignments":[{"id":"4c47c47f-daf9-401c-9148-42e5e00bdcf9","name":"response","value":"={{ $json.concatenated_message_text }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[256,-272],"id":"8ee29def-53c7-4ef0-be72-a595eb88c2ed","name":"Set Successful Response","executeOnce":true},{"parameters":{"assignments":{"assignments":[{"id":"6587096c-e9d7-498e-a8f9-374befde1b85","name":"response","value":"There was a problem searching for places.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1760,-80],"id":"f2e26016-1cbb-4fe7-ae14-53495bd37045","name":"Set Error Response"},{"parameters":{"fieldsToSummarize":{"values":[{"aggregation":"concatenate","field":"message.text","separateBy":"other","customSeparator":"\\n---\\n"}]},"options":{}},"type":"n8n-nodes-base.summarize","typeVersion":1.1,"position":[32,-272],"id":"c62b08cb-6406-44e2-806b-cb8f382c32b2","name":"Concatenate Options"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"0b436d84-0f54-49c9-a0ef-ca5f9d07a4c4","leftValue":"={{ $json.rating }}","rightValue":4.5,"operator":{"type":"number","operation":"gte"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.filter","typeVersion":2.2,"position":[-1536,-272],"id":"6c4840a3-9439-4fb6-bd55-848ccd0d06ee","name":"Filter"},{"parameters":{"type":"random"},"type":"n8n-nodes-base.sort","typeVersion":1,"position":[-1312,-272],"id":"51775905-8ca2-4ab8-be89-3162e17632ef","name":"Randomize"},{"parameters":{"assignments":{"assignments":[{"id":"2bc3e4f7-6d56-495c-addb-2fcd8543c051","name":"=caption","value":"=Option #{{ $itemIndex + 1 }}: *{{$('Limit').item.json.displayName.text}}*  \n\nLink: {{$('Limit').item.json.googleMapsUri}} \nRating: {{ $('Limit').item.json.rating }} \nAddress: {{ $('Limit').item.json.formattedAddress }}\n\nhttps://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/{{ $json.Key }}","type":"string"},{"id":"ca1a3a8e-35a5-4780-9715-58dfac511b4c","name":"tomoWhatsAppId","value":"15551366684","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-416,-272],"id":"6ee172a3-db66-45da-9e98-16926fc03d02","name":"Set Params"},{"parameters":{"workflowId":{"__rl":true,"value":"dl7Ouu4fFql85VAB","mode":"list","cachedResultUrl":"/workflow/dl7Ouu4fFql85VAB","cachedResultName":"[Slack] Send Message"},"workflowInputs":{"mappingMode":"defineBelow","value":{"text":"={{ $json.caption }}","slack_user_id":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}","save":true},"matchingColumns":[],"schema":[{"id":"slack_user_id","displayName":"slack_user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"text","displayName":"text","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"save","displayName":"save","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"boolean","removed":false},{"id":"tool_activity","displayName":"tool_activity","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"array","removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[-192,-272],"id":"e4cd4f2e-312c-4f19-9f95-6bc4e9dc5420","name":"Call '[Slack] Send Message'"},{"parameters":{"workflowId":{"__rl":true,"value":"C9WHFGRGrjz2nQWC","mode":"list","cachedResultUrl":"/workflow/C9WHFGRGrjz2nQWC","cachedResultName":"[Slack] Edit Message"},"workflowInputs":{"mappingMode":"defineBelow","value":{"slack_user_id":"={{ $json.slack_user_id }}","channel_id":"={{ $json.channel_id }}","message_ts":"={{ $json.message_ts }}","text":"_Looking for cool places... :sunglasses:_"},"matchingColumns":[],"schema":[{"id":"slack_user_id","displayName":"slack_user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"text","displayName":"text","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"channel_id","displayName":"channel_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"message_ts","displayName":"message_ts","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{"waitForSubWorkflow":false}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[-2208,-176],"id":"be73744b-9263-4713-96c4-b130435b8578","name":"Call '[Slack] Edit Message'","onError":"continueRegularOutput"},{"parameters":{"url":"=https://places.googleapis.com/v1/{{ $('Limit').item.json.photos[0].name }}/media","sendQuery":true,"queryParameters":{"parameters":[{"name":"key","value":"AIzaSyBpFjB5LAjnIUVf7ZyGSIQ4NWnLjgepcoM"},{"name":"maxHeightPx","value":"1600"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-864,-272],"id":"f78396a7-3ffe-4958-ac66-d505ecf05c98","name":"Download Image","onError":"continueErrorOutput"},{"parameters":{"method":"POST","url":"=https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/tomo_assets/{{$now.toMillis()}}_{{$binary.data.fileName.replaceAll(\" \", \"_\") }}","authentication":"predefinedCredentialType","nodeCredentialType":"supabaseApi","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"={{ $binary.data.mimeType }}"},{"name":"x-upsert","value":"true"}]},"sendBody":true,"contentType":"binaryData","inputDataFieldName":"data","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-640,-272],"id":"3b37955c-c90a-43b0-bb4e-4decf8e1798e","name":"Upload Image to Supabase Storage","retryOnFail":true,"credentials":{"supabaseApi":{"id":"PwJN4yKDRZqivq2f","name":"Supabase account"}}}],"connections":{"Search Places":{"main":[[{"node":"Split Out","type":"main","index":0}],[{"node":"Set Error Response","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Call '[Slack] Edit Message'","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Limit":{"main":[[{"node":"Download Image","type":"main","index":0}]]},"Concatenate Options":{"main":[[{"node":"Set Successful Response","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Randomize","type":"main","index":0}]]},"Randomize":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Set Params":{"main":[[{"node":"Call '[Slack] Send Message'","type":"main","index":0}]]},"Call '[Slack] Send Message'":{"main":[[{"node":"Concatenate Options","type":"main","index":0}]]},"Call '[Slack] Edit Message'":{"main":[[{"node":"Search Places","type":"main","index":0}]]},"Download Image":{"main":[[{"node":"Upload Image to Supabase Storage","type":"main","index":0}]]},"Upload Image to Supabase Storage":{"main":[[{"node":"Set Params","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"When Executed by Another Workflow":[{"json":{"query":"cool restaurants in Usaquén, Bogotá","slack_user_id":"U07U3MJ9SQY","channel_id":"1598386790","message_ts":"4387"}}],"Upload Image to Supabase Storage":[{"json":{"Key":"tomo_assets/1763865598992_unnamed.jpg","Id":"b14c9e60-c100-408b-8cc8-8cddfc221449"}},{"json":{"Key":"tomo_assets/1763865599102_ticr_0_0 (4).jpg","Id":"039e65c0-dede-4bf4-92da-637a42fa15c7"}},{"json":{"Key":"tomo_assets/1763865599108_IMG_4960.JPG","Id":"353bc2d8-4395-430a-a677-9f627ec21eef"}}],"Call '[Slack] Send Message'":[{"json":{"ok":true,"channel":"D09TR7U4DBL","ts":"1763865700.330449","message":{"user":"U09U4508SFK","type":"message","ts":"1763865700.330449","bot_id":"B09TR7TTPM0","app_id":"A09U4GD1064","text":"Option #1: *Lounge de Andrei*  \n\nLink: <https://maps.google.com/?cid=3261129308049135596&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA> \nRating: 4.6 \nAddress: Cra. 6 #116-78, Bogotá, Colombia\n\n<https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865598992_unnamed.jpg>","team":"T02Q7P07G91","bot_profile":{"id":"B09TR7TTPM0","app_id":"A09U4GD1064","user_id":"U09U4508SFK","name":"Ask Tomo","icons":{"image_36":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_36.png","image_48":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_48.png","image_72":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_72.png"},"deleted":false,"updated":1763484497,"team_id":"T02Q7P07G91"},"blocks":[{"type":"rich_text","block_id":"y2RK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Option #1: "},{"type":"text","text":"Lounge de Andrei","style":{"bold":true}},{"type":"text","text":"  \n\nLink: "},{"type":"link","url":"https://maps.google.com/?cid=3261129308049135596&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA","text":"https://maps.google.com/?cid=3261129308049135596&g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA"},{"type":"text","text":" \nRating: 4.6 \nAddress: Cra. 6 #116-78, Bogotá, Colombia\n\n"},{"type":"link","url":"https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865598992_unnamed.jpg"}]}]}],"language":{"locale":"en","is_reliable":true}},"warning":"missing_charset","response_metadata":{"warnings":["missing_charset"]}}},{"json":{"ok":true,"channel":"D09TR7U4DBL","ts":"1763865700.312589","message":{"user":"U09U4508SFK","type":"message","ts":"1763865700.312589","bot_id":"B09TR7TTPM0","app_id":"A09U4GD1064","text":"Option #2: *Tasca La Puerta de Alcalá*  \n\nLink: <https://maps.google.com/?cid=1181418280884942830&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA> \nRating: 4.7 \nAddress: Cl. 118 #5-13, Bogotá, Colombia\n\n<https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865599102_ticr_0_0> (4).jpg","team":"T02Q7P07G91","bot_profile":{"id":"B09TR7TTPM0","app_id":"A09U4GD1064","user_id":"U09U4508SFK","name":"Ask Tomo","icons":{"image_36":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_36.png","image_48":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_48.png","image_72":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_72.png"},"deleted":false,"updated":1763484497,"team_id":"T02Q7P07G91"},"blocks":[{"type":"rich_text","block_id":"fQ/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Option #2: "},{"type":"text","text":"Tasca La Puerta de Alcalá","style":{"bold":true}},{"type":"text","text":"  \n\nLink: "},{"type":"link","url":"https://maps.google.com/?cid=1181418280884942830&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA","text":"https://maps.google.com/?cid=1181418280884942830&g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA"},{"type":"text","text":" \nRating: 4.7 \nAddress: Cl. 118 #5-13, Bogotá, Colombia\n\n"},{"type":"link","url":"https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865599102_ticr_0_0"},{"type":"text","text":" (4).jpg"}]}]}],"language":{"locale":"en","is_reliable":true}},"warning":"missing_charset","response_metadata":{"warnings":["missing_charset"]}}},{"json":{"ok":true,"channel":"D09TR7U4DBL","ts":"1763865700.331219","message":{"user":"U09U4508SFK","type":"message","ts":"1763865700.331219","bot_id":"B09TR7TTPM0","app_id":"A09U4GD1064","text":"Option #3: *Mister Ribs*  \n\nLink: <https://maps.google.com/?cid=17458752883162976879&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA> \nRating: 4.5 \nAddress: Cl. 119 #6 - 06, Bogotá, Colombia\n\n<https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865599108_IMG_4960.JPG>","team":"T02Q7P07G91","bot_profile":{"id":"B09TR7TTPM0","app_id":"A09U4GD1064","user_id":"U09U4508SFK","name":"Ask Tomo","icons":{"image_36":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_36.png","image_48":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_48.png","image_72":"https://avatars.slack-edge.com/2025-11-16/9941183108129_80c916379960edcbc583_72.png"},"deleted":false,"updated":1763484497,"team_id":"T02Q7P07G91"},"blocks":[{"type":"rich_text","block_id":"EcLDL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Option #3: "},{"type":"text","text":"Mister Ribs","style":{"bold":true}},{"type":"text","text":"  \n\nLink: "},{"type":"link","url":"https://maps.google.com/?cid=17458752883162976879&amp;g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA","text":"https://maps.google.com/?cid=17458752883162976879&g_mp=Cidnb29nbGUubWFwcy5wbGFjZXMudjEuUGxhY2VzLlNlYXJjaFRleHQQAhgEIAA"},{"type":"text","text":" \nRating: 4.5 \nAddress: Cl. 119 #6 - 06, Bogotá, Colombia\n\n"},{"type":"link","url":"https://gbwmwbxitjsfrbuqjafz.supabase.co/storage/v1/object/public/tomo_assets/1763865599108_IMG_4960.JPG"}]}]}],"language":{"locale":"en","is_reliable":true}},"warning":"missing_charset","response_metadata":{"warnings":["missing_charset"]}}}]},"versionId":"afc8a090-45cc-4cb2-921d-ef15bf56e231","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-11-22T21:56:58.308Z","createdAt":"2025-11-22T21:56:58.308Z","role":"workflow:owner","workflowId":"GfIHrNUR5C561U2N","projectId":"8nyfoRCh3nEYWaKJ"}],"activeVersion":null,"tags":[]}