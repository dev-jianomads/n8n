{"updatedAt":"2025-11-23T01:15:37.689Z","createdAt":"2025-11-23T01:13:52.530Z","id":"w6HobcwNKb3K2hYo","name":"[Slack] Refresh Cached Slack Chat History and Time Zone","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowId":{"__rl":true,"value":"xrW7FypABHxEoIUp","mode":"list","cachedResultUrl":"/workflow/xrW7FypABHxEoIUp","cachedResultName":"[Slack] Get Slack Conversation"},"workflowInputs":{"mappingMode":"defineBelow","value":{"slack_user_id":"={{ $json.slack_user_id }}"},"matchingColumns":["slack_user_id"],"schema":[{"id":"slack_user_id","displayName":"slack_user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":true,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[-48,-32],"id":"7bdf295f-7df8-4596-81cd-9febf92c26fe","name":"Get Chat History"},{"parameters":{"workflowId":{"__rl":true,"value":"NSHJ7N5HuSWzl9c0","mode":"list","cachedResultUrl":"/workflow/NSHJ7N5HuSWzl9c0","cachedResultName":"[Slack] Get Slack Time Zone [TO-DO]"},"workflowInputs":{"mappingMode":"defineBelow","value":{"userId":"={{ $('When Executed by Another Workflow').item.json.user_id }}"},"matchingColumns":["userId"],"schema":[{"id":"userId","displayName":"userId","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string"}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[400,64],"id":"f20450bf-003f-4d11-8cdb-6f44c37de678","name":"Get Time Zone"},{"parameters":{"operation":"delete","key":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}_SLACK"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[176,-128],"id":"a8c6a889-a287-483f-bdd4-b5ff9a4fe122","name":"Delete Cached Chat History","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"operation":"set","key":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}_SLACK","value":"={{ JSON.stringify($('Get Chat History').first().json.chat_history) }}","expire":true,"ttl":"={{ 1 * 24 * 60 * 60}}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[400,-128],"id":"d5aaa938-5dad-4b42-b20f-bb0297d2a0c1","name":"Cache Chat History","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"workflowInputs":{"values":[{"name":"slack_user_id"},{"name":"user_id"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-272,-32],"id":"ab0be3f6-e9de-436d-aee0-e1721ee7e584","name":"When Executed by Another Workflow"},{"parameters":{"operation":"delete","key":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}_TZ_SLACK"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[624,64],"id":"ec4c034c-a050-4469-8407-6245b975fadf","name":"Delete Cached Time Zone","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"operation":"set","key":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}_TZ_SLACK","value":"={{ $('Get Time Zone').item.json.time_zone }}","expire":true,"ttl":"={{ 1 * 24 * 60 * 60}}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[848,64],"id":"a35a138f-707c-4028-8cb3-9a81faf93dc1","name":"Cache Time Zone","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}},{"parameters":{"operation":"get","propertyName":"currentTimeZone","key":"={{ $('When Executed by Another Workflow').item.json.slack_user_id }}_TZ_SLACK","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[176,64],"id":"ab98ac72-9036-4d93-8c73-3d1397240029","name":"Get TZ","credentials":{"redis":{"id":"UKWNNzdg9opjGBYW","name":"Redis Cache"}}}],"connections":{"Get Chat History":{"main":[[{"node":"Delete Cached Chat History","type":"main","index":0},{"node":"Get TZ","type":"main","index":0}]]},"Get Time Zone":{"main":[[{"node":"Delete Cached Time Zone","type":"main","index":0}]]},"Delete Cached Chat History":{"main":[[{"node":"Cache Chat History","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Get Chat History","type":"main","index":0}]]},"Delete Cached Time Zone":{"main":[[{"node":"Cache Time Zone","type":"main","index":0}]]},"Get TZ":{"main":[[{"node":"Get Time Zone","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"When Executed by Another Workflow":[{"json":{"slack_user_id":"123","user_id":"t07ZDdtiVLduDE3RuRHGKowoSd0f"}}]},"versionId":"6d2b779a-fc86-454c-aac9-183080f2b6c1","triggerCount":0,"shared":[{"updatedAt":"2025-11-23T01:13:52.530Z","createdAt":"2025-11-23T01:13:52.530Z","role":"workflow:owner","workflowId":"w6HobcwNKb3K2hYo","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}