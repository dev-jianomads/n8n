{"updatedAt":"2025-11-20T21:59:59.610Z","createdAt":"2025-11-18T16:44:18.875Z","id":"vqv9sxjCKexF60mn","name":"On Slack Event","active":true,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"slack-events","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[0,0],"id":"2a3fdaab-d313-482a-b518-6c17e3969168","name":"Webhook","webhookId":"d0ead3d8-7c5f-4c5e-97af-5f05871d9a29"},{"parameters":{"conditions":{"options":{"caseSensitive":false,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"59a9a31b-754a-4275-b8bf-fb407604484a","leftValue":"={{ $json.body.event.type }}","rightValue":"message","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{"ignoreCase":true}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[224,0],"id":"ce5b615c-b40a-4c94-8c0a-412896340eda","name":"Message?"},{"parameters":{"operation":"executeQuery","query":"SELECT public.get_slack_user('{{ $json.body.event.user}}');","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[448,0],"id":"ad085d70-cf26-4a43-b2be-1790b39c1bca","name":"Find User by Slack ID","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"c4989d88-5d11-409b-8aee-1ba1fbb0484e","leftValue":"={{ $json.get_slack_user === null}}","rightValue":"","operator":{"type":"boolean","operation":"false","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[656,0],"id":"dd96deb7-bc7f-4b28-a412-007d4ae261c8","name":"Found?"},{"parameters":{"method":"POST","url":"https://slack.com/api/chat.postMessage","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Exchange Code').item.json.access_token }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"channel","value":"={{ $('Exchange Code').item.json.authed_user.id }}"},{"name":"text","value":"=Hi! Please sign up here: https://cal.hellotomo.ai/welcome?service=slack&user_id={{ $('Exchange Code').item.json.authed_user.id }}&team_id={{ $('Exchange Code').item.json.team.id }}&app_id={{ $('Exchange Code').item.json.app_id }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[1024,128],"id":"0b1e19db-8f9b-4e5f-9da8-0d333cd45b29","name":"Send Message"},{"parameters":{"operation":"executeQuery","query":"SELECT public.get_slack_user('{{ $json.body.event.user}}');","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[720,336],"id":"ffd4762f-265b-4042-aaf3-7577d09a745f","name":"Find Token by Team ID","credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}}],"connections":{"Webhook":{"main":[[{"node":"Message?","type":"main","index":0}]]},"Message?":{"main":[[{"node":"Find User by Slack ID","type":"main","index":0}],[]]},"Find User by Slack ID":{"main":[[{"node":"Found?","type":"main","index":0}]]},"Found?":{"main":[[],[{"node":"Find Token by Team ID","type":"main","index":0}]]},"Find Token by Team ID":{"main":[[{"node":"Send Message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"n8n.srv845833.hstgr.cloud","user-agent":"Slackbot 1.0 (+https://api.slack.com/robots)","content-length":"889","accept":"*/*","accept-encoding":"gzip,deflate","content-type":"application/json","x-forwarded-for":"54.227.75.150","x-forwarded-host":"n8n.srv845833.hstgr.cloud","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"ca81421ec8d0","x-real-ip":"54.227.75.150","x-slack-request-timestamp":"1763672228","x-slack-signature":"v0=dc229f1923238183ed78e0a3bfa1036043ad78cc11f45218cca227d2e37a2a74"},"params":{},"query":{},"body":{"token":"jqsfQxQ4MIbURsb09NNTXSCg","team_id":"T02Q7P07G91","context_team_id":"T02Q7P07G91","context_enterprise_id":null,"api_app_id":"A09U4GD1064","event":{"type":"message","user":"U07U3MJ9SQY","ts":"1763672227.664769","client_msg_id":"9da792d2-2467-4178-8443-5cd3ec952ff5","text":"Hi Tomo","team":"T02Q7P07G91","blocks":[{"type":"rich_text","block_id":"6QSsh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi Tomo"}]}]}],"channel":"D09TR7U4DBL","event_ts":"1763672227.664769","channel_type":"im"},"type":"event_callback","event_id":"Ev09UQ6CU7S5","event_time":1763672227,"authorizations":[{"enterprise_id":null,"team_id":"T02Q7P07G91","user_id":"U09U4508SFK","is_bot":true,"is_enterprise_install":false}],"is_ext_shared_channel":false,"event_context":"4-eyJldCI6Im1lc3NhZ2UiLCJ0aWQiOiJUMDJRN1AwN0c5MSIsImFpZCI6IkEwOVU0R0QxMDY0IiwiY2lkIjoiRDA5VFI3VTREQkwifQ"},"webhookUrl":"https://n8n.srv845833.hstgr.cloud/webhook/slack-events","executionMode":"production"}}]},"versionId":"ae1d18aa-3d5d-4b58-a734-dfa5039f1b51","triggerCount":1,"shared":[{"updatedAt":"2025-11-18T16:44:18.875Z","createdAt":"2025-11-18T16:44:18.875Z","role":"workflow:owner","workflowId":"vqv9sxjCKexF60mn","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}