{"createdAt":"2025-05-29T16:23:30.992Z","updatedAt":"2025-07-01T18:41:02.732Z","id":"EuLZafJfE68Dr2cC","name":"🤖 Extract Links and App Name","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"body"},{"name":"sender"},{"name":"taskDescription"},{"name":"subject"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-500,-60],"id":"a7bd9569-3f04-4715-a68c-67450a688b1f","name":"When Executed by Another Workflow"},{"parameters":{"mode":"raw","jsonOutput":"={{ JSON.stringify($json.output) }}","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[812,-60],"id":"200bf7bc-edb7-4811-bf1d-89cd7a04ae6e","name":"Set Response"},{"parameters":{"assignments":{"assignments":[{"id":"098d9f2e-e217-4398-bde9-6db676a1e316","name":"system","value":"=# Role\nAct as Deep Link Extractor, a specialized tool designed to analyze email bodies from Gmail, identify the sender's context (app or person), and extract a deep link related to a specific task mentioned within the email. If no specific task-related deep link is found, provide a default deep link to the homepage of the app that sent the email.\n\n# Task\nYour primary function is to process inputs consisting of an email body, an email address, an email subject, and a task extracted from the email body. From these inputs, you must accurately identify and extract a deep link that is directly related to the mentioned task. If such a link is not found, determine if the email was sent by an app and provide a link to the app's homepage as a fallback. If the email sender is not an app, output should indicate that no deep link is available.\n\n## Specifics\n- Focus solely on the task-related deep link within the email content.\n- If multiple links are present, only extract the one most relevant to the specified task.\n- For emails sent by apps without a specific task-related deep link, default to the app's homepage link.\n- If the email sender is a person or non-app entity, the deep link output should be null.\n- Only return the JSON response; don't add any comments or remarks. Don't wrap it, not even in backticks\n\n# Notes\n- Maintain a straightforward and analytical approach in processing and responding to inputs.\n- Ensure the output is in the correct JSON format as specified in the Example Outputs section.\n- Avoid making assumptions about the content of the email beyond the task at hand and the identification of the sender (app vs. person).\n- Do not attempt to interpret or analyze the email content beyond the scope necessary for identifying the relevant deep link.\n- Prioritize accuracy and relevance in identifying the deep link related to the specified task.\n\n# Example Outputs\nExample output (if sent by an app and a deep link exists) :\n{\"deep_link\": {\"app_name\": \"Make\", \"link\": \"https://us1.make.com/489423/scenarios/3310332/logs\"}}\n\nExample output (if sent by an app and a deep link does not exist):\n{\"deep_link\": {\"app_name\": \"Zoom\", \"link\": \"https://zoom.com\"}}\n\nExample output (if sent by a person and a deep link does not exist):\n{\"deep_link\": {\"app_name\": null, \"link\": null}}","type":"string"},{"id":"bf63ab0e-8438-4c58-b68c-b84b862a6812","name":"user","value":"=## Email subject: {{ $json.subject }}\n\n## Email body:  {{ $json.body }}\n\n## Email sender: {{ $json.sender }}\n\n## Task: {{ $json.taskDescription }}","type":"string"},{"id":"bfb36bc6-024d-4caf-89cd-350a12747cb0","name":"temperature","value":0.2,"type":"number"},{"id":"ec433b14-2ef1-4f54-9ab3-9bc93abd767a","name":"maxTokens","value":512,"type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-280,-60],"id":"ebdc06f3-4ff8-4e98-94c2-529b5c6cf731","name":"Set Prompts & Params"},{"parameters":{"promptType":"define","text":"={{ $json.user }}","hasOutputParser":true,"options":{"systemMessage":"={{ $json.system }}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[-44,-60],"id":"e1bed60b-5a15-4884-b26d-8e35b3ab820c","name":"Link Extractor","retryOnFail":true,"maxTries":5,"onError":"continueErrorOutput"},{"parameters":{"jsonSchemaExample":"{\"deep_link\": {\"app_name\": \"Make\", \"link\": \"https://us1.make.com/489423/scenarios/3310332/logs\"}}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[140,160],"id":"9dceb75d-d093-411b-a6b6-04039d7eb127","name":"Structured Output Parser"},{"parameters":{"promptType":"define","text":"={{ $('Set Prompts & Params').item.json.user }}","hasOutputParser":true,"options":{"systemMessage":"={{ $('Set Prompts & Params').item.json.system }}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[440,20],"id":"09f47eb4-c79e-4c81-8ba2-d0f33fae60e7","name":"Link Extractor (Fallback)","retryOnFail":true,"maxTries":5},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{"maxTokens":"={{ $json.maxTokens }}","temperature":"={{ $json.temperature }}"}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[360,400],"id":"1d77d99a-40ff-4c1f-9393-0d5300ba7571","name":"4.1","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAi account"}}},{"parameters":{"model":"openai/gpt-4.1","options":{"maxTokens":"={{ $json.maxTokens }}","temperature":"={{ $json.temperature }}"}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-60,160],"id":"a9ecffec-44f4-46f0-a65d-8877a8b18e1f","name":"GPT 4.1","credentials":{"openRouterApi":{"id":"SeBKTiKFu0nP1GsL","name":"OpenRouter account"}}}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Set Prompts & Params","type":"main","index":0}]]},"Set Prompts & Params":{"main":[[{"node":"Link Extractor","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Link Extractor","type":"ai_outputParser","index":0},{"node":"Link Extractor (Fallback)","type":"ai_outputParser","index":0}]]},"Link Extractor":{"main":[[{"node":"Set Response","type":"main","index":0}],[{"node":"Link Extractor (Fallback)","type":"main","index":0}]]},"Link Extractor (Fallback)":{"main":[[{"node":"Set Response","type":"main","index":0}]]},"4.1":{"ai_languageModel":[[{"node":"Link Extractor (Fallback)","type":"ai_languageModel","index":0},{"node":"Structured Output Parser","type":"ai_languageModel","index":0}]]},"GPT 4.1":{"ai_languageModel":[[{"node":"Link Extractor","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"63JMaA3ATIsJVc6Y"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"body":"The Hongkong and Shanghai Banking Corporation Limited, 1 Queen's Road Central, Hong Kong.  \n香港上海滙豐銀行有限公司，香港皇后大道中1號\n\n![ ](http://www.iccmap.hsbc.com.hk/teamsite_content/iccm/HBAP/HK/user_contents/images/spacer.gif)\n\n![ ](http://www.iccmap.hsbc.com.hk/teamsite_content/iccm/HSBC/HK/user_contents/images/HSBC_new_BIL_CHI.jpg)\n\n![ ](http://www.iccmap.hsbc.com.hk/teamsite_content/iccm/HBAP/HK/user_contents/images/spacer.gif)\n\nUsername: BAR******G1\n\nDear customer,\n\nTo securely enjoy our online banking services, you are recommended to follow the below steps to change your password at least once **every 90 days**.\n\nStep 1. Log on to Business Internet Banking and click your profile name on top of the page  \nStep 2. Select \"Edit Profile\" under the pull down menu  \nStep 3. Input new password and submit the request. Your new password will be immediately effective.\n\nDon’t forget to keep your username and password confidential and do not disclose your password to anyone claiming to act on behalf of HSBC.\n\n**Recent enhancement**\n\nWe place strong focus on your online security, but we also strive to improve your experience when using Business Internet Banking.\n\nWe understand you wish to enjoy Business Internet Banking securely and efficiently. With our continuous effort in accelerating the page speed via upgrades in our backend systems and platforms, Business Internet Banking page load time has been vastly reduced in mainland China and Hong Kong. You can now enjoy our online banking services faster, but as safe as before.\n\nPlease visit ![ ](http://www.iccmap.hsbc.com.hk/teamsite_content/iccm/HSBC/HK/user_contents/images/url-online-security-en.png) for more guidance on how to protect your account online.\n\nWhenever you are doubtful about your Business Internet Banking activities, please immediately call our Customer Service hotline at (852) 2748 8288.\n\nYours faithfully,  \nHSBC Commercial Banking\n\n使用者名稱：BAR******G1\n\n親愛的客戶：\n\n為確保您能安全地使用我們的網上理財服務，我們建議您按照以下步驟最少**每90天**更改您的密碼一次。\n\n第一步: 登入商務「網上理財」後點擊於頁面頂部的業務名稱  \n第二步: 於選單內選擇「編輯我的業務檔案」  \n第三步: 輸入新密碼並遞交指示。新密碼將會即時生效。\n\n請緊記時刻妥善保密您的使用者名稱及密碼，切勿向任何自稱為匯滙豐職員的人透露您的密碼。\n\n**最新系統升級**\n\n滙豐一貫重視您的網上安全，亦同時致力改善商務「網上理財」的用戶體驗。\n\n我們明白您希望快捷、安全地使用商務「網上理財」。 隨著我們不斷提升系統和平台以加快網站載入速度，商務「網上理財」的頁面載入時間在中國大陸及香港已大幅減少。我們的網上理財服務現更流暢快捷，但同樣安全。\n\n請前往 ![ ](http://www.iccmap.hsbc.com.hk/teamsite_content/iccm/HSBC/HK/user_contents/images/url-online-security-cn.png) 了解更多保障網上安全的指引。如發現您的商務「網上理財」戶口有可疑活動，請即致電我們的客戶服務熱線（852） 2748 8288。\n\n滙豐工商金融  謹啟\n\n**Visit 瀏覽 www.business.hsbc.com.hk | Call 致電 (852) 2748 8288**\n\n**Please do not reply to this email.** Should you wish to contact us, please send an email to commercialbanking@hsbc.com.hk and we will respond to you.\n\nNote: it is important that you do not provide your account or credit card numbers, or disclose any confidential information or banking instructions in your email.\n\nShould you prefer not to receive promotional emails from The Hongkong and Shanghai Banking Corporation Limited, please send us your request by emailing to unsubscribe@hsbc.com.hk. Please use your email address that you would like to stop receiving promotional emails when submitting the request to us. Please do not provide any of your details including your account or credit card number, or disclose any confidential information such as telephone number, other email address, etc in your email. We will arrange to have your email address excluded from our promotional email list without charge. If you wish to make any enquiry or request, please contact us by calling our Customer Service Hotline on +852 2748 8288 and please do not send your enquiry or request to unsubscribe@hsbc.com.hk.\n\nWe maintain strict security standards and procedures to prevent unauthorised access to information about you. HSBC will never contact you by email or otherwise to ask you to validate personal information such as your user ID, password or account numbers. If you receive such a request, please call our Customer Service Hotline on +852 2748 8288.\n\nThis email is confidential. It may also be legally privileged. If you are not the addressee you may not copy, forward, disclose or use any part of it. If you have","sender":"HSBC Business Internet Banking <dbb.notificationcentre@notification.hsbc.com.hk>","taskDescription":"Change Business Internet Banking password","subject":"Time to update your Business Internet Banking password 提提您: 是時候更新您的商務「網上理財」密碼"}}]},"versionId":"bcc64058-5704-4a83-bc28-63c976d2b23b","triggerCount":0,"shared":[{"createdAt":"2025-05-29T16:23:30.992Z","updatedAt":"2025-05-29T16:23:30.992Z","role":"workflow:owner","workflowId":"EuLZafJfE68Dr2cC","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}