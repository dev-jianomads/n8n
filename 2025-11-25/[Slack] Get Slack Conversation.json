{"updatedAt":"2025-11-22T21:48:09.223Z","createdAt":"2025-11-22T21:46:21.721Z","id":"xrW7FypABHxEoIUp","name":"[Slack] Get Slack Conversation","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"slack_user_id"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-528,-16],"id":"bd5d7376-9fef-4a74-9a87-b2876f51e495","name":"When Executed by Another Workflow"},{"parameters":{"aggregate":"aggregateAllItemData","destinationFieldName":"chat_history","options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[144,80],"id":"ed1dcbbd-6c8b-4df1-9b9d-d0367a11d334","name":"Aggregate"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"09465d71-5169-455e-81bd-c6671ebf45ba","leftValue":"={{ $json }}","rightValue":"","operator":{"type":"object","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-80,-16],"id":"17b94b04-80cc-4ad7-9f37-bf3f31652291","name":"Empty?"},{"parameters":{"assignments":{"assignments":[{"id":"55fc4a4c-6b64-454a-8934-c6bc794cc233","name":"chat_history","value":"={{ [] }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[144,-112],"id":"6d549893-c9ff-485a-addb-95e349c02401","name":"Return Empty Array"},{"parameters":{"operation":"executeQuery","query":"SELECT\n  slack_message_ts_utc AS date,\n  text AS message,\n  tool_activity as toolActivity,\n  CASE\n    WHEN direction = 'inbound' THEN 'user'\n    ELSE 'ai'\n  END AS role\nFROM\n  slack_messages\nWHERE (recipient_id = '{{ $('When Executed by Another Workflow').item.json.slack_user_id }}' OR sender_id = '{{ $('When Executed by Another Workflow').item.json.slack_user_id }}')\nORDER BY slack_message_ts DESC;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-304,-16],"id":"fbca2928-6874-40b9-a36f-4930a7f1bb41","name":"Get Slack Messages","retryOnFail":true,"waitBetweenTries":2000,"alwaysOutputData":true,"credentials":{"postgres":{"id":"hcrXy03eb7cfXzVe","name":"Supabase TX Pooler"}}}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Get Slack Messages","type":"main","index":0}]]},"Empty?":{"main":[[{"node":"Return Empty Array","type":"main","index":0}],[{"node":"Aggregate","type":"main","index":0}]]},"Get Slack Messages":{"main":[[{"node":"Empty?","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{"When Executed by Another Workflow":[{"json":{"slack_user_id":"U07U3MJ9SQY"}}]},"versionId":"06a1d94b-36a6-4ae7-a021-5d956593a25c","triggerCount":0,"shared":[{"updatedAt":"2025-11-22T21:46:21.721Z","createdAt":"2025-11-22T21:46:21.721Z","role":"workflow:owner","workflowId":"xrW7FypABHxEoIUp","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}