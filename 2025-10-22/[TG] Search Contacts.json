{"createdAt":"2025-07-30T17:53:21.652Z","updatedAt":"2025-09-02T15:42:47.016Z","id":"8BvX3Fd1lgfaIMh4","name":"[TG] Search Contacts","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"userId"},{"name":"query"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[0,320],"id":"64a789f9-4c33-404e-80ca-163990187d10","name":"When Executed by Another Workflow"},{"parameters":{"workflowId":{"__rl":true,"value":"pE2lsrstziYiLtF8","mode":"list","cachedResultName":"Get Token for TG Integration"},"workflowInputs":{"mappingMode":"defineBelow","value":{"user_id":"={{ $json.userId }}"},"matchingColumns":["user_id"],"schema":[{"id":"user_id","displayName":"user_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[224,320],"id":"800dfa20-b6b8-41f4-8473-065703ec6296","name":"Get Token"},{"parameters":{"url":"=https://people.googleapis.com/v1/people:searchContacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"query","value":"={{ $('When Executed by Another Workflow').item.json.query }}"},{"name":"readMask","value":"names,emailAddresses"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.accessToken }}"},{"name":"Content-Type","value":"application/json"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[448,320],"id":"029b9d3b-bc52-4eef-9c6e-9522ab8fc41e","name":"Search Contacts","retryOnFail":true,"alwaysOutputData":false,"onError":"continueErrorOutput"},{"parameters":{"jsonSchemaExample":"{\n  \"results\": [\n    {\"fullName\": \"Ken Wong\",\n      \"email\": \"ken@jia-nomads.com\",\n      \"number\": 1\n    },\n    {\n      \"fullName\": \"Ken Dad HK\",\n      \"email\": null,\n      \"number\": 2\n    }\n  ]\n}","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[896,128],"id":"56f8a0d3-dd28-4aab-bf7c-7ebb1632aefe","name":"Structured Output Parser"},{"parameters":{"options":{"temperature":0}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[720,128],"id":"85c80cdd-ba3d-4adb-a043-0e6b42856502","name":"4.1 Mini","credentials":{"openRouterApi":{"id":"SeBKTiKFu0nP1GsL","name":"OpenRouter account"}}},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"options":{"temperature":0}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[896,336],"id":"a9d6afba-dd2d-4aa0-8684-5eed40f08ca8","name":"4.1_mini","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAI account"}}},{"parameters":{"promptType":"define","text":"=Take the results from Google Contact's API, and create a simplified JSON list with:\n- Contact Full Name.\n- Contact Email.\n- Number (the number of the contact in the list of results)\n\n## Input:\n{{ JSON.stringify($json.results) }}","hasOutputParser":true,"needsFallback":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[672,-96],"id":"f3fe55d4-6a8d-4722-8f4b-6c66b08153f1","name":"Output Formatter"},{"parameters":{"assignments":{"assignments":[{"id":"7ac574f1-cccb-426d-b676-5b9446410a0d","name":"response","value":"=There was an error: {{ JSON.stringify($json) }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,512],"id":"a238d656-f893-4c7d-92c1-4e493b0bbe34","name":"Error Response"},{"parameters":{"assignments":{"assignments":[{"id":"15d523a5-eab8-482c-9342-58e06eb3af35","name":"response","value":"={{$json.output.results.map(r => r.number + \". Full Name: \" + r.fullName + \"\\n  Email: \" + r.email).join(\"\\n\\n\")}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1296,112],"id":"fc7fd4ec-4619-40b6-8405-9b420c818bd9","name":"Successful Response"},{"parameters":{"url":"=https://people.googleapis.com/v1/otherContacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"readMask","value":"names,emailAddresses"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.accessToken }}"},{"name":"Content-Type","value":"application/json"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[0,736],"id":"0f4c2eb3-7743-4d93-908d-8cc893d034b7","name":"Search Contacts1","retryOnFail":true,"alwaysOutputData":false,"disabled":true,"onError":"continueErrorOutput"}],"connections":{"Get Token":{"main":[[{"node":"Search Contacts","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"Get Token","type":"main","index":0}]]},"Search Contacts":{"main":[[{"node":"Output Formatter","type":"main","index":0}],[{"node":"Error Response","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Output Formatter","type":"ai_outputParser","index":0}]]},"4.1 Mini":{"ai_languageModel":[[{"node":"Output Formatter","type":"ai_languageModel","index":0}]]},"4.1_mini":{"ai_languageModel":[[{"node":"Output Formatter","type":"ai_languageModel","index":1},{"node":"Structured Output Parser","type":"ai_languageModel","index":0}]]},"Output Formatter":{"main":[[{"node":"Successful Response","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Search Contacts":[{"json":{"results":[{"person":{"resourceName":"people/c1467631864186137506","etag":"%EgcBAgkuNz0+GgECIgwvTk8zc0NsQm1XST0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"145e136795dbeba2"},"sourcePrimary":true},"displayName":"Ken Dad HK","givenName":"Ken Dad HK","displayNameLastFirst":"Ken Dad HK","unstructuredName":"Ken Dad HK"}]}},{"person":{"resourceName":"people/c5312739810180299075","etag":"%EgcBAgkuNz0+GgECIgxFYkdQaTA1ZlFqQT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"49baa4b591df7943"},"sourcePrimary":true},"displayName":"Ken Wong","familyName":"Wong","givenName":"Ken","displayNameLastFirst":"Wong, Ken","unstructuredName":"Ken Wong"}]}},{"person":{"resourceName":"people/c5370861444361165055","etag":"%EgcBAgkuNz0+GgECIgxhbE9zUCtRRG1BQT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"4a89220710fd18ff"},"sourcePrimary":true},"displayName":"Ken_冷氣清洗","givenName":"Ken_冷氣清洗","displayNameLastFirst":"Ken_冷氣清洗","unstructuredName":"Ken_冷氣清洗"}]}},{"person":{"resourceName":"people/c7078635452459776502","etag":"%EgcBAgkuNz0+GgECIgxDM2E0SU1YTHZ4bz0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"623c5d709659f9f6"},"sourcePrimary":true},"displayName":"Kennies-shop","givenName":"Kennies-shop","displayNameLastFirst":"Kennies-shop","unstructuredName":"Kennies-shop"}]}},{"person":{"resourceName":"people/c641478538677446606","etag":"%EgcBAgkuNz0+GgECIgwvUkN4OGVqTitWUT0=","names":[{"metadata":{"primary":true,"source":{"type":"CONTACT","id":"8e6fd550ce7e7ce"},"sourcePrimary":true},"displayName":"Carmen Ken","familyName":"Ken","givenName":"Carmen","displayNameLastFirst":"Ken, Carmen","unstructuredName":"Carmen Ken"}]}}]}}],"When Executed by Another Workflow":[{"json":{"userId":"0HpJe5sETk3z9thjekbyzmfSX5Fo","query":"ken"}}]},"versionId":"2f8bffab-88e8-4f6e-96b2-ac000779b221","triggerCount":0,"shared":[{"createdAt":"2025-07-30T17:53:21.652Z","updatedAt":"2025-07-30T17:53:21.652Z","role":"workflow:owner","workflowId":"8BvX3Fd1lgfaIMh4","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}