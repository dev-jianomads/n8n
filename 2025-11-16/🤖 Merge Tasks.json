{"updatedAt":"2025-07-01T18:45:08.272Z","createdAt":"2025-05-29T16:20:45.632Z","id":"Vg55A0mxC7AIO0xQ","name":"ðŸ¤– Merge Tasks","active":false,"isArchived":false,"nodes":[{"parameters":{"workflowInputs":{"values":[{"name":"tasks","type":"array"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-340,-180],"id":"c8d6108d-e467-4667-9b8f-b63759224d91","name":"When Executed by Another Workflow"},{"parameters":{"jsonSchemaExample":"[\n  {\n    \"description\": \"Prepare and send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]","autoFix":true},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[220,42.5],"id":"c331180d-7d2b-4935-8b42-9efb7dc3ed7a","name":"Structured Output Parser"},{"parameters":{"promptType":"define","text":"={{ $json.user }}","hasOutputParser":true,"options":{"systemMessage":"={{ $json.system }}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[120,-180],"id":"ed5ab5b7-d20b-49da-9eb5-aa6100bb40c1","name":"Task Merger","retryOnFail":true,"maxTries":5,"onError":"continueErrorOutput"},{"parameters":{"assignments":{"assignments":[{"id":"098d9f2e-e217-4398-bde9-6db676a1e316","name":"system","value":"=You are an AI agent tasked with analyzing lists of tasks extracted from emails. Your job is to identify tasks that are very similar or closely related and combine them into a single, clear task when appropriate.\n\n**Categories are limited to:** `EVENT`, `REPLY`, `REVIEW`, or `APP`.\n\n### Criteria for combination:\n\n- Tasks have similar descriptions or clearly overlap.\n- Tasks share the same or very similar due dates, priorities, or categories.\n\n### When combining tasks:\n\n- **Description:** Concisely merge descriptions into a single clear action.\n- **Priority:** Use the highest priority among combined tasks (`high` > `medium` > `low`).\n- **Due date:** Use the earliest clearly specified due date.\n- **Category:** Maintain the most relevant common category.\n\nIf no tasks logically require combining, do **not** alter them.\n\n---\n\n### Example Input (should combine):\n\n```json\n[\n  {\n    \"description\": \"Send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-10\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Prepare app report update\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]\n```\n\n### Example Output (combined):\n\n```json\n[\n  {\n    \"description\": \"Prepare and send updated app report to client\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-09\",\n    \"category\": \"APP\"\n  },\n  {\n    \"description\": \"Schedule team event\",\n    \"priority\": \"low\",\n    \"due_date\": \"2024-11-15\",\n    \"category\": \"EVENT\"\n  }\n]\n```\n\n---\n\n### Example Input (no combination):\n\n```json\n[\n  {\n    \"description\": \"Reply to client's question about billing\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-12\",\n    \"category\": \"REPLY\"\n  },\n  {\n    \"description\": \"Review team's project milestones\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-14\",\n    \"category\": \"REVIEW\"\n  }\n]\n```\n\n### Example Output (unchanged):\n\n```json\n[\n  {\n    \"description\": \"Reply to client's question about billing\",\n    \"priority\": \"medium\",\n    \"due_date\": \"2024-11-12\",\n    \"category\": \"REPLY\"\n  },\n  {\n    \"description\": \"Review team's project milestones\",\n    \"priority\": \"high\",\n    \"due_date\": \"2024-11-14\",\n    \"category\": \"REVIEW\"\n  }\n]\n```\n\n---\n\nYour response must always and ONLY be a JSON array of tasks following the structure above.","type":"string"},{"id":"bf63ab0e-8438-4c58-b68c-b84b862a6812","name":"user","value":"={{ JSON.stringify($json.tasks) }}","type":"string"},{"id":"bfb36bc6-024d-4caf-89cd-350a12747cb0","name":"temperature","value":0.5,"type":"number"},{"id":"ec433b14-2ef1-4f54-9ab3-9bc93abd767a","name":"maxTokens","value":-1,"type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-120,-180],"id":"113c2522-bd75-4921-89a8-ad42155c5012","name":"Set Prompts & Params"},{"parameters":{"assignments":{"assignments":[{"id":"49b0007a-0165-4e12-833f-fc1d04abf1a1","name":"tasks","value":"={{ $json.output }}","type":"array"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[940,-180],"id":"882ad1d4-71fe-44a9-a451-765a93f09811","name":"Set Output"},{"parameters":{"promptType":"define","text":"={{ $('Set Prompts & Params').item.json.user }}","hasOutputParser":true,"options":{"systemMessage":"={{ $('Set Prompts & Params').item.json.system }}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[580,-105],"id":"68515701-ed40-4e05-ad16-9ece4560f24d","name":"Task Merger (Fallback)","retryOnFail":true,"maxTries":5},{"parameters":{"model":"openai/gpt-4.1","options":{"maxTokens":"={{ $json.maxTokens }}","temperature":"={{ $json.temperature }}"}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[100,40],"id":"2fe72957-c3ed-47ef-8dad-e5c40f78a263","name":"GPT 4.1","credentials":{"openRouterApi":{"id":"SeBKTiKFu0nP1GsL","name":"OpenRouter account"}}},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{"maxTokens":"={{ $('Set Prompts & Params').item.maxTokens }}","temperature":"={{ $('Set Prompts & Params').item.temperature }}"}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[300,240],"id":"927fb5df-e3a3-4f78-85a5-ff170987de66","name":"4.1","credentials":{"openAiApi":{"id":"JNBPFneOXwzjzSKh","name":"OpenAi account"}}}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Set Prompts & Params","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Task Merger","type":"ai_outputParser","index":0},{"node":"Task Merger (Fallback)","type":"ai_outputParser","index":0}]]},"Task Merger":{"main":[[{"node":"Set Output","type":"main","index":0}],[{"node":"Task Merger (Fallback)","type":"main","index":0}]]},"Set Prompts & Params":{"main":[[{"node":"Task Merger","type":"main","index":0}]]},"Task Merger (Fallback)":{"main":[[{"node":"Set Output","type":"main","index":0}]]},"GPT 4.1":{"ai_languageModel":[[{"node":"Task Merger","type":"ai_languageModel","index":0}]]},"4.1":{"ai_languageModel":[[{"node":"Task Merger (Fallback)","type":"ai_languageModel","index":0},{"node":"Structured Output Parser","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"63JMaA3ATIsJVc6Y"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"1572d092-3dee-44c6-bfbc-1621107232eb","triggerCount":0,"shared":[{"updatedAt":"2025-05-29T16:20:45.632Z","createdAt":"2025-05-29T16:20:45.632Z","role":"workflow:owner","workflowId":"Vg55A0mxC7AIO0xQ","projectId":"8nyfoRCh3nEYWaKJ"}],"tags":[]}